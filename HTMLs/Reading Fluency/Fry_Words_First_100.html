<script>
const fryWordsOriginal = [
  "the","of","and","a","to","in","is","you","that","it",
  "he","was","for","on","are","as","with","his","they","I",
  "at","be","this","have","from","or","one","had","by","word",
  "but","not","what","all","were","we","when","your","can","said",
  "there","use","an","each","which","she","do","how","their","if",
  "will","up","other","about","out","many","then","them","these","so",
  "some","her","would","make","like","him","into","time","has","look",
  "two","more","write","go","see","number","no","way","could","people",
  "my","than","first","water","been","call","who","oil","its","now",
  "find","long","down","day","did","get","come","made","may","part"
];

let fryWords = []; // <-- randomized list

let currentIndex = 0;
let correctWords = [];
let incorrectWords = [];
let startTime = null;
let timerInterval = null;

const wordDisplay = document.getElementById("word");
const timerDisplay = document.getElementById("timer");
const summaryDiv = document.getElementById("summary");

/* ----------- RANDOMIZER ----------- */
function shuffleWords() {
  fryWords = [...fryWordsOriginal]; // copy original
  for (let i = fryWords.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [fryWords[i], fryWords[j]] = [fryWords[j], fryWords[i]];
  }
}

/* Show next Fry word */
function nextWord() {
  if (currentIndex < fryWords.length) {
    wordDisplay.textContent = fryWords[currentIndex];
  } else {
    stopPractice();
  }
}

/* Start timer immediately */
function startTimer() {
  startTime = Date.now();
  timerInterval = setInterval(() => {
    const elapsed = Math.floor((Date.now() - startTime) / 1000);
    timerDisplay.textContent = `Time: ${elapsed}s`;
  }, 1000);
}

/* Stop timer */
function stopTimer() {
  clearInterval(timerInterval);
}

/* Handle answer button or key press */
function recordAnswer(isCorrect) {
  if (isCorrect) {
    correctWords.push(fryWords[currentIndex]);
  } else {
    incorrectWords.push(fryWords[currentIndex]);
  }
  currentIndex++;
  nextWord();
}

/* End practice and show summary */
function stopPractice() {
  stopTimer();
  wordDisplay.style.display = "none";
  document.getElementById("stopButton").style.display = "none";

  const total = correctWords.length + incorrectWords.length;
  const percent = total ? Math.round((correctWords.length / total) * 100) : 0;
  const elapsed = Math.floor((Date.now() - startTime) / 1000);

  summaryDiv.innerHTML = `
    <h2>Results</h2>
    <p><strong>Time:</strong> ${elapsed}s</p>
    <p><strong>Total Words:</strong> ${total}</p>
    <p><strong>Correct:</strong> ${correctWords.length}</p>
    <p><strong>Incorrect:</strong> ${incorrectWords.length}</p>
    <p><strong>Score:</strong> ${percent}%</p>
  `;
  summaryDiv.style.display = "block";
}

/* Reset game */
function resetPractice() {
  stopTimer();
  correctWords = [];
  incorrectWords = [];
  currentIndex = 0;
  summaryDiv.style.display = "none";
  wordDisplay.style.display = "block";
  document.getElementById("stopButton").style.display = "inline-block";
  timerDisplay.textContent = "Time: 0s";

  startTime = null;
  shuffleWords();   // <-- NEW
  startTimer();
  nextWord();
}

/* Keyboard support */
document.addEventListener("keydown", (event) => {
  if (event.key === "1") recordAnswer(true);
  if (event.key === "2") recordAnswer(false);
});

/* Mobile button support */
document.getElementById("correctBtn").onclick = () => recordAnswer(true);
document.getElementById("incorrectBtn").onclick = () => recordAnswer(false);

/* AUTO-START ON LOAD */
window.onload = () => {
  shuffleWords();   // <-- NEW
  startTimer();
  nextWord();
};
</script>
